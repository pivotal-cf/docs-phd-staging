
<!doctype html>
<html>
<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <!-- REPLACE X WITH PRODUCT NAME -->
  <title>Manually Upgrading Pivotal HD Stack from 1.1.1 to 2.0 | Pivotal Docs</title>
    <!-- Local CSS stylesheets -->
    <link href="/stylesheets/master.css" media="screen,print" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/breadcrumbs.css" media="screen,print" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/search.css" media="screen,print" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/portal-style.css" media="screen,print" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/printable.css" media="print" rel="stylesheet" type="text/css" /> 
    <!-- Confluence HTML stylesheet -->
    <link href="/stylesheets/site-conf.css" media="screen,print" rel="stylesheet"  type="text/css" /> 
    <!-- Left-navigation code -->
    <!-- http://www.designchemical.com/lab/jquery-vertical-accordion-menu-plugin/examples/# -->
    <link href="/stylesheets/dcaccordion.css" rel="stylesheet" type="text/css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.cookie.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.hoverIntent.minified.js" type="text/javascript"></script>
    <script src="/javascripts/jquery.dcjqaccordion.2.7.min.js" type="text/javascript"></script>
    <script type="text/javascript">
                    $(document).ready(function($){
					$('#accordion-1').dcAccordion({
						eventType: 'click',
						autoClose: true,
						saveState: true,
						disableLink: false,
						speed: 'fast',
						classActive: 'test',
						showCount: false
					});
					});
        </script>
    <link href="/stylesheets/grey.css" rel="stylesheet" type="text/css" /> 
    <!-- End left-navigation code -->
    <script src="/javascripts/all.js" type="text/javascript"></script>
    <link href='http://www.gopivotal.com/misc/favicon.ico' rel='shortcut icon'>
    <script type="text/javascript">
    if (window.location.host === 'docs.gopivotal.com') {
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-39702075-1']);
        _gaq.push(['_setDomainName', 'gopivotal.com']);
        _gaq.push(['_trackPageview']);

        (function() {
          var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
          ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
          var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    }
  </script>
</head>

<body class="pivotalcf pivotalcf_getstarted pivotalcf_getstarted_index">
  <div class="viewport">
    <div class="mobile-navigation--wrapper mobile-only">
      <div class="navigation-drawer--container">
        <div class="navigation-item-list">
          <div class="navbar-link active">
            <a href="http://gopivotal.com">
              Home
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/paas">
              PaaS
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/big-data">
              Big Data
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/agile">
              Agile
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/support">
              Help &amp; Support
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/products">
              Products
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/solutions">
              Solutions
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/partners">
              Partners
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="mobile-nav">
        <div class="nav-icon js-open-nav-drawer">
          <i class="icon-reorder"></i>
        </div>
        <div class="header-center-icon">
          <a href="http://gopivotal.com">
            <div class="icon icon-pivotal-logo-mobile"></div>
          </a>
        </div>
      </div>
    </div>

    <div class='wrap'>
      <script src="//use.typekit.net/clb0qji.js" type="text/javascript"></script>
      <script type="text/javascript">
          try {
              Typekit.load();
          } catch (e) {
          }
      </script>
      <script type="text/javascript">
          document.domain = "gopivotal.com";
      </script>

	<script type="text/javascript">
	  WebFontConfig = {
	    google: { families: [ 'Source+Sans+Pro:300italic,400italic,600italic,300,400,600:latin' ] }
	  };
	  (function() {
	    var wf = document.createElement('script');
	    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
	      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
	    wf.type = 'text/javascript';
	    wf.async = 'true';
	    var s = document.getElementsByTagName('script')[0];
	    s.parentNode.insertBefore(wf, s);
	  })(); </script>

      <div id="search-dropdown-box">
        <div class="search-dropdown--container js-search-dropdown">
          <div class="container-fluid">
            <div class="close-menu-large"><img src="http://www.gopivotal.com/sites/all/themes/gopo13/images/icon-close.png" /></div>
            <div class="search-form--container">
              <div class="form-search">
                <div class='gcse-search'></div>
                <script src="http://www.google.com/jsapi" type="text/javascript"></script>
                <script src="/javascripts/cse.js" type="text/javascript"></script>
              </div>
            </div>
          </div>
        </div>
      </div>

      <header class="navbar desktop-only" id="nav">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="pivotal-logo--container">
                    <a class="pivotal-logo" href="http://gopivotal.com"><span></span></a>
                </div>

                <ul class="nav pull-right">
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/paas" id="paas-nav-link">PaaS</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/big-data" id="big-data-nav-link">BIG DATA</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/agile" id="agile-nav-link">AGILE</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/oss" id="oss-nav-link">OSS</a>
                    </li>
                    <li class="nav-search">
                        <a class="js-search-input-open" id="click-to-search"><span></span></a>
                    </li>
                </ul>
            </div>
            <a href="http://www.gopivotal.com/contact">
                <img id="get-started" src="http://www.gopivotal.com/sites/all/themes/gopo13/images/get-started.png">
            </a>
        </div>
      </header>
      <div class="main-wrap">
        <div class="container-fluid">

          <!-- Google CSE Search Box -->
          <div id='docs-search'>
              <gcse:search></gcse:search>
          </div>
          
          <div id='all-docs-link'>
            <a href="http://docs.gopivotal.com/">All Documentation</a>
          </div>
          
          <div class="container">
            <div id="sub-nav" class="nav-container">              
              
              <!-- Collapsible left-navigation-->
				<ul class="accordion"  id="accordion-1">
					<!-- REPLACE <li/> NODES-->
                        <li>
                <a href="index.html">Home</a></br>
                                
                        <li>
                <a href="PivotalHD.html">Pivotal HD 2.0.1</a>

                            <ul>
                    <li>
                <a href="PHDEnterprise2.0.1ReleaseNotes.html">PHD Enterprise 2.0.1 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDInstallationandAdministration.html">PHD Installation and Administration</a>

                            <ul>
                    <li>
                <a href="OverviewofPHD.html">Overview of PHD</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallationOverview.html">Installation Overview</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDInstallationChecklist.html">PHD Installation Checklist</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingPHDUsingtheCLI.html">Installing PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UpgradeChecklist.html">Upgrade Checklist</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UpgradingPHDUsingtheCLI.html">Upgrading PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="AdministeringPHDUsingtheCLI.html">Administering PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDFAQFrequentlyAskedQuestions.html">PHD FAQ (Frequently Asked Questions)</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDTroubleshooting.html">PHD Troubleshooting</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="StackandToolsReference.html">Stack and Tools Reference</a>

                            <ul>
                    <li>
                <a href="OverviewofApacheStackandPivotalComponents.html">Overview of Apache Stack and Pivotal Components</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManuallyInstallingPivotalHD2.0Stack.html">Manually Installing Pivotal HD 2.0 Stack</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0.html">Manually Upgrading Pivotal HD Stack from 1.1.1 to 2.0</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PivotalHadoopEnhancements.html">Pivotal Hadoop Enhancements</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="Security.html">Security</a>

                    </li>
            </ul>
            </li>
            </ul>
            </li>
                        <li>
                <a href="PivotalCommandCenter.html">Pivotal Command Center 2.2.1</a>

                            <ul>
                    <li>
                <a href="PCC2.2.1ReleaseNotes.html">PCC 2.2.1 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PCCUserGuide.html">PCC User Guide</a>

                            <ul>
                    <li>
                <a href="PCCOverview.html">PCC Overview</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PCCInstallationChecklist.html">PCC Installation Checklist</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingPCC.html">Installing PCC</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UsingPCC.html">Using PCC</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="CreatingaYUMEPELRepository.html">Creating a YUM EPEL Repository</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="CommandLineReference.html">Command Line Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
            </li>
                        <li>
                <a href="PivotalHAWQ.html">Pivotal HAWQ 1.2.0</a>

                            <ul>
                    <li>
                <a href="HAWQ1.2.0.1ReleaseNotes.html">HAWQ 1.2.0.1 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQInstallationandUpgrade.html">HAWQ Installation and Upgrade</a>

                            <ul>
                    <li>
                <a href="PreparingtoInstallHAWQ.html">Preparing to Install HAWQ</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingHAWQ.html">Installing HAWQ</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingtheHAWQComponents.html">Installing the HAWQ Components</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UpgradingHAWQandComponents.html">Upgrading HAWQ and Components</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQConfigurationParameterReference.html">HAWQ Configuration Parameter Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQAdministration.html">HAWQ Administration</a>

                            <ul>
                    <li>
                <a href="HAWQOverview.html">HAWQ Overview</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQQueryProcessing.html">HAWQ Query Processing</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UsingHAWQtoQueryData.html">Using HAWQ to Query Data</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ConfiguringClientAuthentication.html">Configuring Client Authentication</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="KerberosAuthentication.html">Kerberos Authentication</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ExpandingtheHAWQSystem.html">Expanding the HAWQ System</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQInputFormatforMapReduce.html">HAWQ InputFormat for MapReduce</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQFilespacesandHighAvailabilityEnabledHDFS.html">HAWQ Filespaces and High Availability Enabled HDFS</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="SQLCommandReference.html">SQL Command Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManagementUtilityReference.html">Management Utility Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ClientUtilityReference.html">Client Utility Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQServerConfigurationParameters.html">HAWQ Server Configuration Parameters</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQEnvironmentVariables.html">HAWQ Environment Variables</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQDataTypes.html">HAWQ Data Types</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="SystemCatalogReference.html">System Catalog Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="hawq_toolkitReference.html">hawq_toolkit Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="PivotalExtensionFrameworkPXF.html">Pivotal Extension Framework (PXF)</a>

                            <ul>
                    <li>
                <a href="PXFInstallationandAdministration.html">PXF Installation and Administration</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PXFExternalTableandAPIReference.html">PXF External Table and API Reference</a>

                    </li>
            </ul>
            </div><!--end of sub-nav-->
            
            <h3 class="title-container">Manually Upgrading Pivotal HD Stack from 1.1.1 to 2.0</h3>
            <div class="content">
              <!-- Python script replaces main content -->
			  <div id ="main"><div style="visibility:hidden; height:2px;">Pivotal Product Documentation : Manually Upgrading Pivotal HD Stack from 1.1.1 to 2.0</div><div class="wiki-content group" id="main-content">
<p>This section describes how to manually upgrade your Pivotal HD stack components from 1.1.1 to 2.0.</p><p><style type="text/css">/*<![CDATA[*/
div.rbtoc1400035785638 {padding: 0px;}
div.rbtoc1400035785638 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1400035785638 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1400035785638">
<ul class="toc-indentation">
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-GeneralUpgradeTasksforEachComponent">General Upgrade Tasks for Each Component</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-AccessingthePHD2.0RPM">Accessing the PHD 2.0 RPM</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-PHDRPMUpgradeLimitationsfromPHD1.1.1toPHD2.0">PHD RPM Upgrade Limitations from PHD 1.1.1 to PHD 2.0</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-ComponentstobeUpgraded(ICMsupported)">Components to be Upgraded (ICM supported)</a>
<ul class="toc-indentation">
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeBigtopUtilities">Upgrade Bigtop Utilities</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeZookeeper">Upgrade Zookeeper</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHadoop">Upgrade Hadoop</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHBase">Upgrade HBase</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHive">Upgrade Hive</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradePig">Upgrade Pig</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeMahout">Upgrade Mahout</a></li>
</ul>
</li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-ComponentstobeUpgraded(ICMnotsupported)">Components to be Upgraded (ICM not supported)</a>
<ul class="toc-indentation">
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeFlume">Upgrade Flume</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeSqoop">Upgrade Sqoop</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeOozie">Upgrade Oozie</a></li>
<li><a href="#ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHCatalog">Upgrade HCatalog</a></li>
</ul>
</li>
</ul>
</div></p><p>PHD supports only stack-level upgrade; it doesn't support component-level upgrade. All PHD components should come from same release package and all PHD components need to upgrade to same release version.</p><h2 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-GeneralUpgradeTasksforEachComponent">General Upgrade Tasks for Each Component</h2><p>For each component upgrade, the following steps need to be followed:</p><ul><li>Backup Configuration</li><li>Stop Service</li><li>RPM upgrade</li><li>Restore Configuration</li><li>Start Service</li></ul><h2 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-AccessingthePHD2.0RPM">Accessing the PHD 2.0 RPM</h2><p>Download and extract PHD package to working directory:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ tar zxvf PHD-2.0.0.0-&lt;nn&gt;.tar.gz
$ ls -p PHD-2.0.0.0-&lt;nn&gt;
flume/     hadoop/   hbase/     hive/    oozie/                        pig/    utility/
graphlab/  hamster/  hcatalog/  mahout/  open_source_licenses_PHD.txt  sqoop/  zookeeper/</pre>
</div></div><p>We define the replaced string that will be used in the following sections for each component.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Component</th><th class="confluenceTh" style="text-align: center;">PHD Version</th><th class="confluenceTh" style="text-align: center;">Replaced String</th></tr><tr><td class="confluenceTd">Hadoop</td><td class="confluenceTd">2.2.0_gphd_3_0_0_0</td><td class="confluenceTd">&lt;PHD_HADOOP_VERSION&gt;</td></tr><tr><td class="confluenceTd">HBase</td><td class="confluenceTd">0.96.0_gphd_3_0_0_0</td><td class="confluenceTd">&lt;PHD_HBASE_VERSION&gt;</td></tr><tr><td class="confluenceTd">Hive</td><td class="confluenceTd">0.12.0_gphd_3_0_0_0</td><td class="confluenceTd">&lt;PHD_HIVE_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Pig</td><td class="confluenceTd" colspan="1">0.12.0_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_PIG_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Mahout</td><td class="confluenceTd" colspan="1">0.7_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_MAHOUT_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">HCatalog</td><td class="confluenceTd" colspan="1">0.12.0_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_HCATALOG_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Sqoop</td><td class="confluenceTd" colspan="1">1.4.2_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_SQOOP_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Flume</td><td class="confluenceTd" colspan="1">1.4.0_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_FLUME_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Zookeeper</td><td class="confluenceTd" colspan="1">3.4.5_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_ZOOKEEPER_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">Oozie</td><td class="confluenceTd" colspan="1">4.0.0_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_OOZIE_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">bigtop-jsvc</td><td class="confluenceTd" colspan="1">1.0.15_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_BIGTOP_JSVC_VERSION&gt;</td></tr><tr><td class="confluenceTd" colspan="1">bigtop-utils</td><td class="confluenceTd" colspan="1">0.4.0_gphd_3_0_0_0</td><td class="confluenceTd" colspan="1">&lt;PHD_BIGTOP_UTILS_VERSION&gt;</td></tr></tbody></table></div><h2 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-PHDRPMUpgradeLimitationsfromPHD1.1.1toPHD2.0">PHD RPM Upgrade Limitations from PHD 1.1.1 to PHD 2.0<strong> <br/> </strong></h2><p>Some files in PHD 1.1.1 cannot be uninstalled after upgrade from PHD 1.1.1 to PHD 2.0.</p><h2 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-ComponentstobeUpgraded(ICMsupported)">Components to be Upgraded (ICM supported)</h2><ul><li>Zookeeper</li><li>Bigtop utilities</li><li>HDFS</li><li>Yarn</li><li>HBase</li><li>Hive</li><li>Pig</li><li>Mahout</li></ul><p>The above components upgrade is supported through the CLI. Manual RPM upgrade is risky and upgrade through the CLI is strongly recommended.</p><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeBigtopUtilities">Upgrade Bigtop Utilities</h3><p>     RPM Upgrade Bigtop Utilies</p><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeZookeeper">Upgrade Zookeeper</h3><ol><li>Backup existing configuration files.</li><li>Stop the zookeeper-server service.</li><li>RPM Upgrade Zookeeper.</li><li>Restore backup configuration files and make sure configuration is compatible with the new installed version.</li><li>Restart the zookeeper-server service on Zookeeper server.</li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHadoop">Upgrade Hadoop</h3><p>     Refer to <a class="external-link" href="http://wiki.apache.org/hadoop/Hadoop_Upgrade" rel="nofollow">http://wiki.apache.org/hadoop/Hadoop_Upgrade</a> for Hadoop data upgrade/migration. The following steps only cover Hadoop configuration and packages upgrade.</p><ol><li>Backup existing configuration files.</li><li>Stop Hadoop services.</li><li>RPM upgrade Hadoop.</li><li>Restore backup configuration files and make sure configuration is compatible with new installed version.</li><li>Restart Hadoop services.</li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHBase">Upgrade HBase</h3><p>     Refer to<a class="external-link" href="http://hbase.apache.org/upgrading.html" rel="nofollow"> http://hbase.apache.org/upgrading.html</a> for hbase data upgrade/migration. The following steps only cover hbase configuration and packages upgrade.</p><ol><li>Backup existing configuration files.</li><li>Stop HBase master/region/thrift/restful service.</li><li>RPM upgrade Hbase.</li><li>Restore backup configuration files and make sure configuration is compatible with the new installed version.</li><li>Restart HBase master/region/thrift/restful service.</li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHive">Upgrade Hive</h3><p>     Refer to<a class="external-link" href="https://cwiki.apache.org/confluence/display/Hive/Hive+Schema+Tool" rel="nofollow">https://cwiki.apache.org/confluence/display/Hive/Hive+Schema+Tool</a> for Hive data upgrade/migration. The following steps only cover Hive configuration and packages upgrade.</p><ol><li>Backup existing configuration files.</li><li>Stop Hive Server, Hive Server2, metastore services.</li><li>RPM upgrade Hive</li><li>Restore backup configuration files and make sure configuration is compatible with the new installed version.</li><li>If you use postgresql as the metastore DB, please copy postgresql-jdbc.jar to /usr/lib/gphd/hive/lib on hive-server node.</li><li>Restart Hive Server, Hive Server2, metastore services.</li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradePig">Upgrade Pig</h3><ol><li>Backup existing configuration files.</li><li>RPM upgrade Pig.</li><li>Restore backup configuration files and make sure configuration is compatible with new installed version.</li><li>Restore any customized UDF jars to lib directory.</li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeMahout">Upgrade Mahout</h3><ol><li>Backup existing configuration files.</li><li>RPM upgrade Mahout</li><li>Restore backup configuration files and make sure configuration is compatible with new installed version.</li></ol><h2 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-ComponentstobeUpgraded(ICMnotsupported)">Components to be Upgraded (ICM not supported)</h2><ul><li>Sqoop</li><li>Flume</li><li>Oozie</li><li>Hcatlog</li></ul><p>These instructions assume that the following components were already upgraded to PHD stack 1.1.1 and worked correctly:</p><ul><li>Zookeeper</li><li>Hadoop</li><li>Hbase</li><li>Hive</li><li>Pig</li><li>Mahout</li></ul><p>RPM upgrade requires <code>root</code> privileges on the nodes to be upgraded. Unless specified, all the following operations should be run by user <code>root</code>.</p><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeFlume">Upgrade Flume</h3><ol><li><p><strong>Backup existing configuration files</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ cp -r /etc/gphd/flume/conf &lt;where to save Flume configuration&gt;
$ cp -r /etc/default/flume* &lt;where to save Flume environment&gt;</pre>
</div></div></li><li><p><strong>Stop Flume Agent Service</strong></p><p>Before you begin the upgrade, stop the<code> flume-agent</code> service:<strong> <br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service flume-agent stop
</pre>
</div></div><p><strong> <br/> </strong></p></li><li><p><strong> <strong>Upgrade the Flume Client<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo rpm -U flume-&lt;PHD_FLUME_VERSIOIN&gt;.noarch.rpm
$ sudo rpm -qa | grep flume
flume-&lt;PHD_FLUME_VERSION&gt;.noarch</pre>
</div></div></li><li><p><strong> <strong>Upgrade the Flume Agent<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo rpm -U flume-&lt;PHD_FLUME_VERSION&gt;.noarch.rpm flume-agent-&lt;PHD_FLUME_VERSION&gt;.noarch.rpm
$ sudo rpm -qa | grep flume
flume-&lt;PHD_FLUME_VERSION&gt;.noarch
flume-agent-&lt;PHD_FLUME_VERSION&gt;.noarch</pre>
</div></div></li><li><p><strong> <strong>Restore the old configurations<br/> </strong> </strong></p><p>After upgrading all Flume packages, you need to restore your configuration files in <code>/etc/gphd/flume/conf</code>, especially the <code>flume.conf</code>.<br/>Check your previous backup configuration files, and manually add any change you made back to your upgraded configuration files.<br/>You also need to restore flume environment files in /etc/default, if they were changed.</p></li><li><p><strong>Restart Flume Agent Service</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service flume-agent start
</pre>
</div></div></li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeSqoop">Upgrade Sqoop</h3><ol><li><strong>Backup existing configuration files</strong> <br/><p>We also require you back up the external jar files used to connect with the database for Sqoop:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ cp -r /etc/gphd/sqoop/conf &lt;where to save Sqoop configuration&gt;
$ cp -r /usr/lib/gphd/sqoop/lib &lt;where to save external jar files&gt;
$ cp -r /etc/default/sqoop* &lt;where to save Sqoop environment&gt;</pre>
</div></div></li><li><p><strong>Stop Sqoop Metastore Service<br/> </strong>Before you run the upgrade, first stop the <code>sqoop-metastore</code> service:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service sqoop-metastore stop
</pre>
</div></div></li><li><p><strong>Upgrade Sqoop Client<br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U sqoop-&lt;PHD_SQOOP_VERSION&gt;.noarch.rpm
$ rpm -qa | grep sqoop
sqoop-&lt;PHD_SQOOP_VERSION&gt;.noarch</pre>
</div></div></li><li><p><strong>Upgrade Sqoop Metastore</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U sqoop-&lt;PHD_SQOOP_VERSION&gt;.noarch.rpm  sqoop-metastore-&lt;PHD_SQOOP_VERSION&gt;.noarch.rpm
$ rpm -qa | grep sqoop
sqoop-&lt;PHD_SQOOP_VERSION&gt;.noarch
sqoop-metastore-&lt;PHD_SQOOP_VERSION&gt;.noarch</pre>
</div></div></li><li><strong> <strong>Restore old configurations<br/> </strong> </strong><p>After upgrading all Sqoop packages, you need to restore your configuration files in <code>/etc/gphd/sqoop/conf</code>, especially the <code>sqoop-site.xml</code>.</p><p>Check your previous backup configuration files, and manually add back any change you made to your upgraded configuration files.</p><p>You also need to restore your external jar files to <code>/usr/lib/gphd/sqoop/lib</code>.<br/>You also need to restore Sqoop environment files in /etc/default, if they were changed. </p><strong> <br/> </strong></li><li><p><strong> <strong>Restart Sqoop Metastore service<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service sqoop-metastore start
</pre>
</div></div></li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeOozie">Upgrade Oozie</h3><ol><li><p><strong>Backup existing configuration files</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ cp -r /etc/gphd/oozie/conf &lt;where to save Oozie configuration&gt;</pre>
</div></div></li><li><p><strong>Stop Oozie Service<br/> </strong>Before you run the upgrade, first stop <code>Oozie</code> service:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service oozie stop
</pre>
</div></div></li><li><p><strong>Upgrade Oozie Rpms<br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo rpm -U oozie-client-&lt;PHD_OOZIE_VERSION&gt;.noarch.rpm oozie-&lt;PHD_OOZIE_VERSION&gt;.noarch.rpm
$ sudo rpm -qa | grep oozie
oozie-client-&lt;PHD_OOZIE_VERSION&gt;.noarch
oozie-&lt;PHD_OOZIE_VERSION&gt;.noarch</pre>
</div></div></li><li><p><strong>Clean up Tomcat container files</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo rm -rf /usr/lib/gphd/oozie-&lt;PHD_OOZIE_OLD_VERSION&gt;</pre>
</div></div> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>PHD_OOZIE_OLD_VERSION is the old Oozie version in previous PHD release.</p>
</div>
</div>
<p><strong> <br/> </strong></p></li><li><p><strong>Copy Oozie Data</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo -u oozie cp -r /var/lib/gphd/oozie-&lt;PHD_OOZIE_OLD_VERSION&gt;/* /var/lib/gphd/oozie/</pre>
</div></div> <div class="aui-message warning shadowed information-macro">
<span class="aui-icon icon-warning">Icon</span>
<div class="message-content">
<p>PHD_OOZIE_OLD_VERSION is the old Oozie version in previous PHD release. The default OOZIE_DATA is "/var/lib/gphd/oozie/". If OOZIE_DATA is set to another path, you have to put it into the path you set.</p>
</div>
</div>
</li><li><strong> <strong>Restore old configurations<br/> </strong> </strong><p>After upgrading all Oozie packages, you need to restore your configuration files in <code>/etc/gphd/oozie/conf</code> <br/> Check your previous backup configuration files, and manually add any change you made back to your upgraded configuration files.<br/> You also need to restore Oozie environment files in /etc/default, if they were changed.  </p><strong> <br/> </strong></li><li><p><strong>Upgrade Oozie database</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo -u oozie oozie-setup db upgrade -run
$ sudo -u oozie oozie-setup db postupgrade -run
</pre>
</div></div></li><li><p><strong style="background-color: transparent;font-size: 14.0px;line-height: 1.42857;"> <strong>Init new version Oozie Service</strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo -u oozie oozie-setup prepare-war -d &lt;ext-js-2.2-path&gt;
$ sudo -u oozie hdfs dfs -rm -r share
Deleted share
$ sudo -u oozie oozie-setup sharelib create -fs hdfs://&lt;NameNodeHost&gt;:&lt;HDFSPort&gt;</pre>
</div></div><p><strong>Note</strong>: Make sure that there is a file named "ext-2.2.zip" in &lt;ext-js-2.2-path &gt;.</p></li><li><p><strong> <strong>Restart Oozie service<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service oozie start
</pre>
</div></div></li></ol><h3 id="ManuallyUpgradingPivotalHDStackfrom1.1.1to2.0-UpgradeHCatalog">Upgrade HCatalog</h3><ol><li><p><strong>Backup existing configuration files</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ cp -r /etc/gphd/hcatalog/conf &lt;where to save HCatlog configuration&gt;
$ cp -r /etc/default/hcatalog* &lt;where to save HCatlog environment&gt;
$ cp -r /etc/default/webhcat* &lt;where to save Webhcat environment&gt;</pre>
</div></div></li><li><p><strong>Stop webhcat-server Service</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service webhcat-server stop
</pre>
</div></div></li><li><p><strong>Stop hcatalog-server Service<br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service hcatalog-server stop
</pre>
</div></div></li><li><p><strong>Upgrade <strong>webhcat-server</strong> <br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U webhcat-server-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm
$ rpm -qa | grep webhcat-server
webhcat-server-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm</pre>
</div></div></li><li><p><strong>Upgrade <strong>webhcat</strong> <br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U webhcat-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm
$ rpm -qa | grep webhcat
webhcat-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm</pre>
</div></div></li><li><p><strong>Upgrade hcatalog-server</strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U hcatalog-server-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm
$ rpm -qa | grep hcatalog-server
hcatalog-server-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm</pre>
</div></div></li><li><p><strong>Upgrade <strong>hcatalog</strong> <br/> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ rpm -U hcatalog-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm
$ rpm -qa | grep hcatalog
hcatalog-&lt;PHD_HCATALOG_VERSION&gt;.noarch.rpm</pre>
</div></div></li><li><strong> <strong>Restore old configurations<br/> </strong> </strong><p>After upgrading all  packages, you need to restore your configuration files in /etc/gphd/hcatalog/conf.</p><p>Check your previous backup configuration files, and manually add any change you made back to your upgraded configuration files.<br/> You also need to restore hcatalog and webhcat environment files in /etc/default if they were changed.</p><strong> <br/> </strong></li><li><p><strong> <strong>Restart </strong> </strong> <strong> <strong>webhcat-server</strong> </strong> <strong> <strong> service<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service webhcat-server start
</pre>
</div></div></li><li><p><strong> <strong>Restart </strong> </strong> <strong>hcatalog-server</strong> <strong> <strong> service<br/> </strong> </strong></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">$ sudo service hcatalog-server start
</pre>
</div></div></li></ol>
</div></div>
            </div><!-- end of content-->
            
            
          </div><!-- end of container -->
        </div><!--end of container-fluid-->
      </div><!--end of main-wrap-->

      <div class="site-footer desktop-only">
          <div class="container-fluid">
              <div class="site-footer-links">
                  <span class="version"><a href='/'>Pivotal Documentation</a></span>
                  <span>&copy;
                      <script>
                          var d = new Date();
                          document.write(d.getFullYear());
                      </script>
                      <a href='http://gopivotal.com'>Pivotal Software</a> Inc. All Rights Reserved.
                  </span>
              </div>
          </div>
      </div>

      <script type="text/javascript">
          (function() {
              var didInit = false;
              function initMunchkin() {
                  if(didInit === false) {
                      didInit = true;
                      Munchkin.init('625-IUJ-009');
                  }
              }
              var s = document.createElement('script');
              s.type = 'text/javascript';
              s.async = true;
              s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
              s.onreadystatechange = function() {
                  if (this.readyState == 'complete' || this.readyState == 'loaded') {
                      initMunchkin();
                  }
              };
              s.onload = initMunchkin;
              document.getElementsByTagName('head')[0].appendChild(s);
          })();
      </script>
  </div><!--end of viewport-->
  <div id="scrim"></div>
</body>
</html>