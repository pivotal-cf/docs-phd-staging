
<!doctype html>
<html>
<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <!-- REPLACE X WITH PRODUCT NAME -->
  <title>PHD Troubleshooting | Pivotal HD/PCC/ADS Documentation</title>
  <!-- Local CSS stylesheets -->
  <link href="/stylesheets/master.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/breadcrumbs.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/search.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/portal-style.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="/stylesheets/printable.css" media="print" rel="stylesheet" type="text/css" /> 
  <!-- Confluence HTML stylesheet -->
  <link href="/stylesheets/site-conf.css" media="screen,print" rel="stylesheet"  type="text/css" /> 
  <!-- Left-navigation code -->
  <!-- http://www.designchemical.com/lab/jquery-vertical-accordion-menu-plugin/examples/# -->
  <link href="/stylesheets/dcaccordion.css" rel="stylesheet" type="text/css" />
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.cookie.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.hoverIntent.minified.js" type="text/javascript"></script>
  <script src="/javascripts/jquery.dcjqaccordion.2.7.min.js" type="text/javascript"></script>
  <script type="text/javascript">
                    $(document).ready(function($){
					$('#accordion-1').dcAccordion({
						eventType: 'click',
						autoClose: true,
						saveState: true,
						disableLink: false,
						speed: 'fast',
						classActive: 'test',
						showCount: false
					});
					});
  </script>
  
  <link href="/stylesheets/grey.css" rel="stylesheet" type="text/css" /> 
  <!-- End left-navigation code -->
  <script src="/javascripts/all.js" type="text/javascript"></script>
  <link href='http://www.gopivotal.com/misc/favicon.ico' rel='shortcut icon'>
</head>

<body class="pivotalcf pivotalcf_getstarted pivotalcf_getstarted_index">
  <div class="viewport">
    <div class="mobile-navigation--wrapper mobile-only">
      <div class="navigation-drawer--container">
        <div class="navigation-item-list">
          <div class="navbar-link active">
            <a href="http://gopivotal.com">
              Home
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/paas">
              PaaS
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/big-data">
              Big Data
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/agile">
              Agile
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/support">
              Help &amp; Support
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/products">
              Products
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/solutions">
              Solutions
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/partners">
              Partners
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="mobile-nav">
        <div class="nav-icon js-open-nav-drawer">
          <i class="icon-reorder"></i>
        </div>
        <div class="header-center-icon">
          <a href="http://gopivotal.com">
            <div class="icon icon-pivotal-logo-mobile"></div>
          </a>
        </div>
      </div>
    </div>

    <div class='wrap'>
      <script src="//use.typekit.net/clb0qji.js" type="text/javascript"></script>
      <script type="text/javascript">
          try {
              Typekit.load();
          } catch (e) {
          }
      </script>
      <script type="text/javascript">
          document.domain = "gopivotal.com";
      </script>
      <div id="search-dropdown-box">
        <div class="search-dropdown--container js-search-dropdown">
          <div class="container-fluid">
            <div class="close-menu-large"><img src="http://www.gopivotal.com/sites/all/themes/gopo13/images/icon-close.png" /></div>
            <div class="search-form--container">
              <div class="form-search">
                <div class='gcse-search'></div>
                <script src="http://www.google.com/jsapi" type="text/javascript"></script>
                <script src="/javascripts/cse.js" type="text/javascript"></script>
              </div>
            </div>
          </div>
        </div>
      </div>

      <header class="navbar desktop-only" id="nav">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="pivotal-logo--container">
                    <a class="pivotal-logo" href="http://gopivotal.com"><span></span></a>
                </div>

                <ul class="nav pull-right">
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/paas" id="paas-nav-link">PaaS</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/big-data" id="big-data-nav-link">BIG DATA</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/agile" id="agile-nav-link">AGILE</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/oss" id="oss-nav-link">OSS</a>
                    </li>
                    <li class="nav-search">
                        <a class="js-search-input-open" id="click-to-search"><span></span></a>
                    </li>
                </ul>
            </div>
            <a href="http://www.gopivotal.com/contact">
                <img id="get-started" src="http://www.gopivotal.com/sites/all/themes/gopo13/images/get-started.png">
            </a>
        </div>
      </header>
      <div class="main-wrap">
        <div class="container-fluid">

          <!-- Google CSE Search Box -->
          <div id='docs-search'>
              <gcse:search></gcse:search>
          </div>
          
          <div id='all-docs-link'>
            <a href="/">All Documentation</a>
          </div>
          
          <div class="container">
            <div id="sub-nav" class="nav-container">              
              
              <!-- Collapsible left-navigation-->
			  <ul class="accordion"  id="accordion-1">
				  <!-- REPLACE <li/> NODES-->

                        <li>
                <a href="index.html">Home</a>
                        </li>

                        <li>
                <a href="PivotalHD.html">Pivotal HD 1.1.1</a>

                            <ul>
                    <li>
                <a href="PHDEnterprise1.1.1ReleaseNotes.html">PHD Enterprise 1.1.1 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDServiceBrokerforPivotalCFv1.0.0.0.html">PHD Service Broker for Pivotal CF v1.0.0.0</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDInstallationandAdministration.html">PHD Installation and Administration</a>

                            <ul>
                    <li>
                <a href="OverviewofPHD.html">Overview of PHD</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingPHDUsingtheCLI.html">Installing PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UpgradingPHDUsingtheCLI.html">Upgrading PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="AdministeringPHDUsingtheCLI.html">Administering PHD Using the CLI</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDFAQFrequentlyAskedQuestions.html">PHD FAQ (Frequently Asked Questions)</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDTroubleshooting.html">PHD Troubleshooting</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="StackandToolsReference.html">Stack and Tools Reference</a>

                            <ul>
                    <li>
                <a href="OverviewofApacheStackandPivotalComponents.html">Overview of Apache Stack and Pivotal Components</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHD1.1.1Stack-RPMPackage.html">PHD 1.1.1 Stack - RPM Package</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHD1.1.1Stack-BinaryPackage.html">PHD 1.1.1 Stack - Binary Package</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDMR11.1Stack-RPMPackage.html">PHD MR1 1.1 Stack - RPM Package</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDMR11.1Stack-BinaryPackage.html">PHD MR1 1.1 Stack - Binary Package</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PHDStack-OtherComponents.html">PHD Stack - Other Components</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="USSUnifiedStorageSystem.html">USS (Unified Storage System)</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HVEHadoopVirtualizationExtensions.html">HVE (Hadoop Virtualization Extensions)</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="Security.html">Security</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManuallyUpgradingPHDfrom1.1to1.1.1-RPM.html">Manually Upgrading PHD from 1.1 to 1.1.1 - RPM</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManuallyUpgradingPHDfrom1.1to1.1.1-Binary.html">Manually Upgrading PHD from 1.1 to 1.1.1 - Binary</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="DataLoaderInstallationandUsage.html">DataLoader Installation and Usage</a>

                            <ul>
                    <li>
                <a href="OverviewofDataLoader.html">Overview of DataLoader</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingandConfiguringDataLoader.html">Installing and Configuring DataLoader</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UsingDataLoader.html">Using DataLoader</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="LoadingFilesandPushStreamsintoHAWQUsingPXF.html">Loading Files and Push Streams into HAWQ Using PXF</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="DataLoaderCommandLineInterface.html">DataLoader Command Line Interface</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="DataLoaderCopyStrategyandTransferPolicy.html">DataLoader Copy Strategy and Transfer Policy</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="JobTransferSpecification.html">Job (Transfer) Specification</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="DataStores.html">Data Stores</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ConfiguringFlumeforDataLoaderPushStreaming.html">Configuring Flume for DataLoader Push Streaming</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="DataLoaderInstallationfromBinaries.html">DataLoader Installation from Binaries</a>

                    </li>
            </ul>
            </li>
            </ul>
            </li>
                        <li>
                <a href="PivotalCommandCenter.html">Pivotal Command Center 2.1.1</a>

                            <ul>
                    <li>
                <a href="PCC2.1.1ReleaseNotes.html">PCC 2.1.1 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PCCUserGuide.html">PCC User Guide</a>

                            <ul>
                    <li>
                <a href="PCCOverview.html">PCC Overview</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="InstallingPCC.html">Installing PCC</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="UsingPCC.html">Using PCC</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="CreatingaYUMEPELRepository.html">Creating a YUM EPEL Repository</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="CommandLineReference.html">Command Line Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
            </li>
                        <li>
                <a href="PivotalAdvancedDatabaseServices.html">Pivotal Advanced Database Services 1.1.4</a>

                            <ul>
                    <li>
                <a href="PADS1.1.4ReleaseNotes.html">PADS 1.1.4 Release Notes</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQInstallation.html">HAWQ Installation</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQAdministration.html">HAWQ Administration</a>

                            <ul>
                    <li>
                <a href="HAWQOverview.html">HAWQ Overview</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQQueryProcessing.html">HAWQ Query Processing</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="QueryingData.html">Querying Data</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ConfiguringClientAuthentication.html">Configuring Client Authentication</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="KerberosAuthentication.html">Kerberos Authentication</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQInputFormatforMapReduce.html">HAWQ InputFormat for MapReduce</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="SQLCommandReference.html">SQL Command Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ManagementUtilityReference.html">Management Utility Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ClientUtilityReference.html">Client Utility Reference</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="ServerConfigurationParameters.html">Server Configuration Parameters</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQEnvironmentVariables.html">HAWQ Environment Variables</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="HAWQDataTypes.html">HAWQ Data Types</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="MADlibReferences.html">MADlib References</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="hawq_toolkitReference.html">hawq_toolkit Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
                    <ul>
                    <li>
                <a href="PivotalExtensionFrameworkPXF.html">Pivotal Extension Framework (PXF)</a>

                            <ul>
                    <li>
                <a href="PXFInstallationandAdministration.html">PXF Installation and Administration</a>

                    </li>
            </ul>
                    <ul>
                    <li>
                <a href="PXFExternalTableandAPIReference.html">PXF External Table and API Reference</a>

                    </li>
            </ul>
            </li>
            </ul>
            </li>
              </ul>        
              
            </div><!--end of sub-nav-->
            <div class="body-container content">

              <!-- Python script replaces main content -->
			  <div id ="main"><h1>PHD Troubleshooting</h1><div class="wiki-content group" id="main-content">
<p><style type="text/css">/*<![CDATA[*/
div.rbtoc1390012349557 {padding: 0px;}
div.rbtoc1390012349557 ul {list-style: none;margin-left: 0px;}
div.rbtoc1390012349557 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc rbtoc1390012349557">
<ul class="toc-indentation">
<li><a href="#PivotalHDEnterpriseTroubleshooting-DebuggingErrors">Debugging Errors</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-PivotalHDInstallation">Pivotal HD Installation</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ClusterDeployment">Cluster Deployment<em>  </em></a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ClusterNodesInstallation">Cluster Nodes Installation<em>  </em></a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ServicesStart">Services Start</a></li>
</ul>
<li><a href="#PivotalHDEnterpriseTroubleshooting-PuppetSSLErrors">Puppet SSL Errors</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-Upgrade/ReconfigureErrors">Upgrade/Reconfigure Errors</a>
<ul class="toc-indentation">
<li><a href="#PivotalHDEnterpriseTroubleshooting-FollowinganupgradeofCommandCenter,unabletoStart/Stopclusterwithinvalidhostnames">Following an upgrade of Command Center, unable to Start/Stop cluster with invalid hostnames</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-OtherUpgrade/ReconfigureErrors">Other Upgrade/Reconfigure Errors</a></li>
</ul>
</li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-HA-relatedErrors">HA-related Errors</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-OtherErrors">Other Errors</a>
<ul class="toc-indentation">
<li><a href="#PivotalHDEnterpriseTroubleshooting-ClusterDeploymentFailsduetoRPMDependencies">Cluster Deployment Fails due to RPM Dependencies</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-UnabletoaccesstheNamenodeStatusWebpage">Unable to access the Namenode Status Web page</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-InstallationFailsduetoDirectoryPermissions">Installation Fails due to Directory Permissions</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-DeploymentFailsduetoProblemswithyumRepository">Deployment Fails due to Problems with yum Repository</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-InstallationFailsduetoProblemswiththeSSLcertificate">Installation Fails due to Problems with the SSL certificate</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ClusterNodeInstallationFailurewithoutGeneratingaLogFile">Cluster Node Installation Failure without Generating a Log File</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-Puppetcertificatefailure">Puppet certificate failure</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-PackageBundleNotFound">Package Bundle Not Found</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ClusterDeploymentFailsduetoMissingPackages">Cluster Deployment Fails due to Missing Packages</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-WorkingwithProxyServers">Working with Proxy Servers</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-Capitallettersinhostname">Capital letters in hostname</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-Resolvingpostgresportconflictissue">Resolving postgres port conflict issue</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ResolvingHTTPportconflict">Resolving HTTP port conflict</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-SeeingerrorslikeAmbitpushfailed">Seeing errors like Ambit push failed</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-Preparehostserrorsoutwhilecreatinggpadminuser">Preparehosts errors out while creating gpadmin user</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-HAWQinitializationfailing">HAWQ initialization failing</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-InstallingHAWQondirtyclusternodespreviouslyconfiguredwithHAWQ">Installing HAWQ on dirty cluster nodes previously configured with HAWQ</a></li>
<li><a href="#PivotalHDEnterpriseTroubleshooting-ErrorsRelatedtoVMMemory">Errors Related to VM Memory</a></li>
</ul>
</li></div></p><p>This section provides common errors you may receive and how to troubleshoot or workaround those errors.</p><h3 id="PivotalHDEnterpriseTroubleshooting-DebuggingErrors">Debugging Errors</h3><p>Pivotal Command Center has many different log files. Finding the exact log may initially be challenging at the beginning.</p><p>Here is a quick guide on how to identify the issues:</p><h3 id="PivotalHDEnterpriseTroubleshooting-PivotalHDInstallation">Pivotal HD Installation</h3><p>All installation errors will be logged under:<br/> <code>/var/log/gphd/gphdmgr/installer.log</code></p><h3 id="PivotalHDEnterpriseTroubleshooting-ClusterDeployment">Cluster Deployment<em>  </em></h3><p>If you see a 500 Internal Server Error, check the following logs for details:<br/> <code>/var/log/gphd/gphdmgr/gphdmgr-webservices.log</code></p><p>If you see Puppet cert generation errors, check<br/> <code>/var/log/gphd/gphdmgr/gphdmgr-webservices.log</code></p><p>If config properties are not making into the cluster nodes, check<br/> <code>/var/log/gphd/gphdmgr/gphdmgr-webservices.log</code></p><p>If you see <code>GPHDClusterInstaller.py</code> script execution error, check<br/> <code>/var/log/gphd/gphdmgr/GPHDClusterInstaller_XXX.log</code></p><p>Sometimes <code>/var/log/messages</code> can also have good information especially if the deployment fails during the puppet deploy stage.</p><p>In general if something fails on the server side, look at the logs in this order:<br/> <code>/var/log/gphd/gphdmgr/gphdmgr-webservices.log </code><br/><code> /var/log/gphd/gphdmgr/GPHDClusterInstaller_XXX.log </code><br/><code> /var/log/messages</code></p><h3 id="PivotalHDEnterpriseTroubleshooting-ClusterNodesInstallation">Cluster Nodes Installation<em>  </em></h3><p>If there are no errors on the admin side, but the installation failed on the cluster nodes, check the latest log file:<br/> <code>/tmp/GPHDNodeInstaller_XXX.log</code></p><p>Search for the first occurrence of the word "merr" that will point to the most probable issue.</p><h3 id="PivotalHDEnterpriseTroubleshooting-ServicesStart">Services Start</h3><p>Check for the corresponding log file under<code> /var/log/gphd/</code> directory.</p><p>For example, if the namenode doesn't start, please look at the<code> /var/log/gphd/hadoop/hadoop-hdfs-namenode-hostname.log</code> file for details.</p><h2 id="PivotalHDEnterpriseTroubleshooting-PuppetSSLErrors">Puppet SSL Errors</h2><p>For errors like:<br/> <code>"Unable to generate certificates" </code><br/><code> "SSLv3 authentication issues on the client"</code></p><p>As root, do the following:</p><p>Ensure the hostname on all machines is a fully qualified domain name. (see the HOSTNAME field in <code>/etc/sysconfig/network</code>)</p><p>Run:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">service commander stop
</pre>
</div></div><p>On <strong>all machines including cluster nodes</strong>, run </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">rm -rf /var/lib/puppet/ssl-icm/*
</pre>
</div></div><p><strong>On the admin node</strong>, ensure there is no puppet master process running by running:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">ps ef | grep puppet
</pre>
</div></div><p>If there is, <code>kill -9 </code>any running puppet process:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">ps -ef|grep puppet|awk '{print $2}'|xargs kill -9</pre>
</div></div><p>Make sure there are no certificates listed by running:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">puppetca list --all 
</pre>
</div></div><p>You can run <code>puppetca clean --all </code>to clean any certificates</p><p>Restart the puppet master:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">service puppetmaster start 
</pre>
</div></div><p>Verify there is just one certificate:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">puppetca list --all
</pre>
</div></div><p>Stop the puppet master and start nmon:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">service puppetmaster stop

service commander start
</pre>
</div></div><p>Now retry your deployment.</p><h2 id="PivotalHDEnterpriseTroubleshooting-Upgrade/ReconfigureErrors">Upgrade/Reconfigure Errors</h2><h3 id="PivotalHDEnterpriseTroubleshooting-FollowinganupgradeofCommandCenter,unabletoStart/Stopclusterwithinvalidhostnames">Following an upgrade of Command Center, unable to Start/Stop cluster with invalid hostnames</h3><p>This is because there is now a check for invalid characters in cluster names.</p><div><strong>Workaround</strong>: First reconfigure the cluster to a different name:</div><div><p> </p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">icm_client reconfigure -l &lt;old_cluster_name&gt; -c &lt;config directory with new clustername&gt;</pre>
</div></div><p>Then try starting/stopping the cluster:</p></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">icm_client start -l &lt;cluster_name&gt;
icm_client stop -l &lt;cluster_name&gt;</pre>
</div></div><h3 id="PivotalHDEnterpriseTroubleshooting-OtherUpgrade/ReconfigureErrors">Other Upgrade/Reconfigure Errors</h3><div><p>After upgrading PHD stack from 1.0.2 to 1.0.3 release, hbase master fails to start if hbase-master is not co-located with either namenode or datanode.<br/> <strong>Workaround</strong>: On hbase-master node, run "yum upgrade hadoop-hdfs". Go to /usr/lib/gphd directory. Point the hadoop-hdfs symlink to the newer hadoop-hdfs version.</p></div><p>If see a "hostRoleMapping should not be changed for other services" error, make sure the clusterConfig.xml file has not been changed for any of the already existing services. Even if it is the same set of hosts but in a different order please ensure to maintain the order in the comma separated list.</p><p>If you see "ERROR:Fetching hadoop rpm name on namenode: &lt;<em>host</em>&gt; failed" error, it is most likely a case where the cluster was being upgraded from 1.0.0 to 1.0.2 and there was an error during upgrade. <br/> <strong>Workaround</strong>: Run <code>yum install hadoop-2.0.2_alpha_gphd_2_0_1_0-14.x86_64</code> on the namenode and retry upgrade.</p><p>If you are upgrading a cluster with hbase, hive or pxf configured as a service you must manually reinstall those services. See <a href="UpgradingPHDUsingtheCLI.html">Upgrading Pivotal HD Enterprise Using the CLI</a> for details.</p><h2 id="PivotalHDEnterpriseTroubleshooting-HA-relatedErrors">HA-related Errors</h2><p>If the cluster fails to start with HA enabled:</p><ul><li>Check status of journal node (/etc/init.d/hadoop-hdfs-journalnode status) on all hosts and ensure they are running. </li><li>Check if the "namenode" (configured as namenodeid1 in clusterconfig.xml) is formatted and successfully started. Be sure to check <code>/var/log/gphd/gphdmgr/gphdmgr-webservices.log</code> and if needed the namenode logs on the namenode host: <code>/usr/lib/gphd/hadoop/logs/hadoop-hdfs-namenode*log</code></li><li>Check if the "standbynamenode" (configured as namenodeid2 in clusterconfig.xml) is formatted and successfully started. The namenode logs should have details on any errors if the standbynamenode failed to format or start</li><li>If standbynamenode fails to start because it is not formatted and restarting the cluster does not format the name node please contact support team for help.</li><li>If you are converting a non-HA cluster to HA please make sure to follow the documented steps. It is important to start the journal nodes and initialize the edit logs from the namenode of the existing cluster before starting the cluster.</li></ul><h2 id="PivotalHDEnterpriseTroubleshooting-OtherErrors">Other Errors</h2><h3 id="PivotalHDEnterpriseTroubleshooting-ClusterDeploymentFailsduetoRPMDependencies">Cluster Deployment Fails due to RPM Dependencies</h3><p>Ensure that the base OS repo is available. You might have to mount the CD that comes with the OS installation or point yum to the correct location such as NFS mount point on all the cluster nodes</p><h3 id="PivotalHDEnterpriseTroubleshooting-UnabletoaccesstheNamenodeStatusWebpage">Unable to access the Namenode Status Web page</h3><p>If the host returns a short hostname instead of FQDN for hostname(), it is possible that the namenode status link cannot be accessed from external networks.</p><p>The solution is to either ensure that the <code>hostname()</code> returns FQDN on the namenode host (or) Change the <code>dfs.http.address</code> value to <code>0.0.0.0</code> in the<code> hdfs-site.xml</code> and restart <code>namenode&lt;property&gt;</code><br/><code> &lt;name&gt;dfs.http.address&lt;/name&gt;</code><br/><code> &lt;value&gt;0.0.0.0:50070&lt;/value&gt;</code><br/><code> &lt;/property&gt;</code></p><h3 id="PivotalHDEnterpriseTroubleshooting-InstallationFailsduetoDirectoryPermissions">Installation Fails due to Directory Permissions</h3><p>Please check if the umask is set to 0022. If not please set the umask in the .bashrc as "umask 0022" and retry the PCC installation.</p><h3 id="PivotalHDEnterpriseTroubleshooting-DeploymentFailsduetoProblemswithyumRepository">Deployment Fails due to Problems with yum Repository</h3><p>Please verify that the admin node is reachable from the agent node.<br/> If you have configured proxy servers, please refer the section titled "Working with Proxy servers" in the troubleshooting section on the work arounds.</p><h3 id="PivotalHDEnterpriseTroubleshooting-InstallationFailsduetoProblemswiththeSSLcertificate">Installation Fails due to Problems with the SSL certificate</h3><p>Check if <code>dnsdomainname</code> returns empty value. If yes, you need to ensure that the <code>dnsdomainname</code> returns the correct domain.</p><h3 id="PivotalHDEnterpriseTroubleshooting-ClusterNodeInstallationFailurewithoutGeneratingaLogFile">Cluster Node Installation Failure without Generating a Log File</h3><p>Ensure that passwordless ssh is setup between the admin node and the cluster nodes.<br/> Ensure that the puppet, facter and ruby rpms are the same as that on the admin node<br/> Ensure that the user <code>gpadmin</code> has sudo and no requiretty access on the cluster node (check for the existence of file: <code>/etc/sudoers.d/gpadmin</code>)</p><p>And retry the deployment</p><h3 id="PivotalHDEnterpriseTroubleshooting-Puppetcertificatefailure">Puppet certificate failure</h3><p>Follow the instructions in the "Handling Puppet SSL errors" of Troubleshooting</p><h3 id="PivotalHDEnterpriseTroubleshooting-PackageBundleNotFound">Package Bundle Not Found</h3><p>If you sudo in to the system as root, ensure that you sudo with the environment. That is:<code> sudo su -</code>  Do not forget the hyphen at the end.</p><p>If you directly login as root with password and if you still see the above issue, check if /usr/local/bin/bundle exists.  If not, build it:<br/> <code>gem install bundler</code><br/> Add <code>/usr/local/bin</code> to <code>PATH</code>, regardless:<code> []# vi ~/.bashrc</code><br/> Append <code>export PATH=$PATH:/usr/local/bin</code> and save<br/> <code>[]# source ~/.bashrc</code></p><h3 id="PivotalHDEnterpriseTroubleshooting-ClusterDeploymentFailsduetoMissingPackages">Cluster Deployment Fails due to Missing Packages</h3><p>The above error can be identified by following the instructions on "Cluster Nodes Installation Errors" section above.</p><p>Install <em>nc</em> and <em>postgres-devel</em> packages on all the cluster nodes or point them to a repo that contains the rpms.</p><h3 id="PivotalHDEnterpriseTroubleshooting-WorkingwithProxyServers">Working with Proxy Servers</h3><p>It might sometimes be required for all outgoing http traffic to use a HTTP proxy. PCC installer might sometimes pull rpms from external repos like epel6 repo if the external repos are configured and if any packages are missing on the host.</p><p>If you configure the proxy settings in <code>/etc/yum.conf</code> the cluster node, cluster deployments might fail because yum will send all <code>gphd.repo</code> requests to the proxy which in turn will fail to connect to the admin node local repo.</p><p>Here are a few workarounds:</p><p><strong>Workaround 1</strong></p><ul class="alternate"><li style="list-style-type: none;background-image: none;"><ul class="alternate"><li>Remove the proxy settings from <code>yum.conf</code> and</li><li>Make sure following params are set in <code>~root/.bashr</code>c</li></ul></li></ul><p style="margin-left: 30.0px;">For example:<br/> <code>export http_proxy=<span class="nolink">http://proxy:3333</span> </code><br/><code> export no_proxy=local.domain ## this is the local domain for hadoop cluster</code></p><ul class="alternate"><li style="list-style-type: none;background-image: none;"><ul class="alternate"><li>Modify these files so gphd.repo gets pushed out with fqdn name instead of shortname:<br/> <code>/etc/puppet/modules/yumrepo/templates/yumrepo.erb</code></li></ul></li></ul><p style="margin-left: 30.0px;">change from:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">baseurl=http://&lt;%= scope.lookupvar("params::config::admin_host")  %&gt;/&lt;%= scope.lookupvar("params::config::repopath") %&gt;
</pre>
</div></div><p style="margin-left: 30.0px;">change to:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">&lt;replace node.full.domain.com&gt; with the FQDN of the admin node
baseurl=http://node.full.domain.com/&lt;%= scope.lookupvar("params::config::repopath") %&gt;
</pre>
</div></div><p><strong>Workaround 2</strong></p><ul class="alternate"><li>Enable NFS and export <code>/usr/lib/gphd/rpms</code> to all cluster nodes</li><li>Mount the nfs repo on all cluster nodes:</li></ul><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">          mount gpcc:/usr/lib/gphd/rpms /local_repo
</pre>
</div></div><ul class="alternate"><li style="list-style-type: none;background-image: none;"><ul class="alternate"><li>modify these files:<br/> <code>/etc/puppet/modules/yumrepo/templates/yumrepo.erb</code></li></ul></li></ul><p style="margin-left: 30.0px;">change from:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">baseurl=http://&lt;%= scope.lookupvar("params::config::admin_host")  %&gt;/&lt;%= scope.lookupvar("params::config::repopath") %&gt;
</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">change to: baseurl={nolink:file:///local_repo/}
</pre>
</div></div><h3 id="PivotalHDEnterpriseTroubleshooting-Capitallettersinhostname">Capital letters in hostname</h3><p>PCC fails to deploy if the hostnames contain uppercase letters. For example: <code>Node0781.domain.com</code>.<br/> Rename the hostname with only lowercase letters before proceeding with the deployment.</p><h3 id="PivotalHDEnterpriseTroubleshooting-Resolvingpostgresportconflictissue">Resolving postgres port conflict issue</h3><p>If you face a postgres port conflict or wish to change the default postgres port, please follow the steps below:</p><ol><li><p>Stop PCC service:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">root# service commander stop</pre>
</div></div></li><li><p>Add the new port <code>&lt;hostname&gt;:5435</code> in the Pivotal HD properties file: <code><br/>vim /etc/gphd/gphdmgr/conf/gphdmgr.properties</code></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">gphdmgr.db.url=jdbc:postgresql://localhost:5435/gphdmgr  </pre>
</div></div></li><li>Change the port number in <code>postgresql.conf</code>:<br/><p><code>vim /var/lib/pgsql/data/postgresql.conf "port = 5435" </code></p></li><li><p>Edit the <code>init.d/postgresql</code> file:<code><br/><br/>vim /etc/init.d/postgresql</code></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">#Change the PGPORT to 5435 "PGPORT=5435"  
root# service commander start</pre>
</div></div></li></ol><h3 id="PivotalHDEnterpriseTroubleshooting-ResolvingHTTPportconflict">Resolving HTTP port conflict</h3><p>Check the FAQ section: How do I change the port used by Pivotal HD?</p><h3 id="PivotalHDEnterpriseTroubleshooting-SeeingerrorslikeAmbitpushfailed">Seeing errors like Ambit push failed</h3><p>If you see errors like the following:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="theme: Confluence; brush: java; gutter: false" style="font-size:12px;">root# icm_client add-user-gpadmin -f hosts
Ambit : Push Failed
Had : Push Failed
Issues : Push Failed
Generating : Push Failed
A : Push Failed
List : Push Failed
</pre>
</div></div><p>This is an ambit bug. If there are hostnames (only the name part, not the domain) which are substrings of other hostnames then this issue seems to occur.</p><p>For example: host1.emc.com, host11.emc.com</p><p>This error can be ignored for now as the actual deployment still goes through.</p><h3 id="PivotalHDEnterpriseTroubleshooting-Preparehostserrorsoutwhilecreatinggpadminuser">Preparehosts errors out while creating gpadmin user</h3><p>Make sure SELinux needs to be either disabled or in permissive mode for the hosts. </p><p>(See the <em>Pivotal Command Center Installation and User Guide</em> for instructions to disable SELinux)</p><h3 id="PivotalHDEnterpriseTroubleshooting-HAWQinitializationfailing">HAWQ initialization failing</h3><p>Make sure your cluster is up and running with the hadoop services prior to running hawq init. If the failure still persists, make sure the hawq nodes have been prepared (refer to prepare-hawq-hosts) to reflect the kernel configurations required for HAWQ. If you still have a problem you might be running short of the memory required to run HAWQ at scale. Please refer to the HAWQ guide to configure/modify the system memory requirements.</p><h3 id="PivotalHDEnterpriseTroubleshooting-InstallingHAWQondirtyclusternodespreviouslyconfiguredwithHAWQ">Installing HAWQ on dirty cluster nodes previously configured with HAWQ</h3><p>If you wish the deploy or initialize HAWQ on</p><p>a) Cluster which had an older uninstalled hawq cluster, or</p><p>b) Cluster that failed in its attempts to initialize hawq, you will need to do the following before Intializing HAWQ with the new cluster nodes.</p><p><code>HAWQ_Hosts.txt</code> contains all the HAWQ hosts that you want to clean up.</p><p>You will need to run the below command against each DIRECTORY configured in <code>&lt;hawq.segment.directory&gt;</code> and in <code>&lt;hawq.master.directory&gt;</code> in the cluster configuration (<code>clusterConfig.xml</code>)</p><p><code>gpadmin# massh HAWQ_Hosts.txt verbose 'sudo rm -rf DIRECTORY/*'</code></p><p>The above command cleans up the stale hawq master and segment data directory contents.</p><h3 id="PivotalHDEnterpriseTroubleshooting-ErrorsRelatedtoVMMemory">Errors Related to VM Memory</h3><p style="list-style-type: none;background-image: none;">If you are planning to deploy a HAWQ cluster on VMs with memory lower than the optimized/recommended requirements, you may encounter <em>Could not create the Java virtual machine</em> type errors.  In these cases you can reconfigure memory usage, as follows:</p><ul><li>Remove the entry <code>vm.overcommit_memory = 2</code> from <code>/usr/lib/gphd/gphdmgr/hawq_sys_config/sysctl.conf</code> prior to running the prepare HAWQ utility.</li><li>In the <code>clusterConfig.xml</code>, update <code>&lt;hawq.segment.directory&gt;</code> to include only one segment directory entry (instead of the default 4 segments).</li></ul>
</div></div>


            </div><!-- end of body-container content-->
          </div><!-- end of container -->
        </div><!--end of container-fluid-->
      </div><!--end of main-wrap-->

      <div class="site-footer desktop-only">
          <div class="container-fluid">
              <div class="site-footer-links">
                  <span class="version"><a href='/'>Pivotal Documentation</a></span>
                  <span>&copy;
                      <script>
                          var d = new Date();
                          document.write(d.getFullYear());
                      </script>
                      <a href='http://gopivotal.com'>Pivotal Software</a> Inc. All Rights Reserved.
                  </span>
              </div>
          </div>
      </div>

      <script type="text/javascript">
          (function() {
              var didInit = false;
              function initMunchkin() {
                  if(didInit === false) {
                      didInit = true;
                      Munchkin.init('625-IUJ-009');
                  }
              }
              var s = document.createElement('script');
              s.type = 'text/javascript';
              s.async = true;
              s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
              s.onreadystatechange = function() {
                  if (this.readyState == 'complete' || this.readyState == 'loaded') {
                      initMunchkin();
                  }
              };
              s.onload = initMunchkin;
              document.getElementsByTagName('head')[0].appendChild(s);
          })();
      </script>
  </div><!--end of viewport-->
  <div id="scrim"></div>
</body>
</html>